@model WorkflowOrder
@using Envision.TravelManagement.Core.Template.Templates
@using Framework
@using System
@using System.Globalization
@using System.Linq
@helper Passengers(BaseServiceTemplate serviceItem)  {
    foreach (var p in serviceItem.AllPassengers)   {
<tr style="background-color:#eaeaea">
    <td style="padding: 5px;border-left: 1px solid #fff;">@p.Name  </td>
    <td style="padding: 5px;border-left: 1px solid #fff;">@p.BirthDate </td>
    <td style="padding: 5px;border-left: 1px solid #fff;">@p.Type</td>
</tr>	
    }
}
 
@functions {
    public static string ParseFarePaxTypeToPassengerType(string farePaxType)
    {
        if (!string.IsNullOrWhiteSpace(farePaxType))          {
            switch (farePaxType)
            {
                case "Child":
                    return "Chd";
                case "Baby":
                    return "Inf";
                default:
                    return "Adt";
            }
        }
        return string.Empty;
    }

    public static decimal MarkupedFareAmountFromAirBook(dynamic airBookAuxiliar, string farePaxType)   {
        var calculatedMarkup = 0m;
        if (airBookAuxiliar != null && airBookAuxiliar.Fields != null && airBookAuxiliar.Fields.Fares != null)
        {
            var fares = (List<object>
    ) airBookAuxiliar.Fields.Fares;
    if (fares != null && fares.Count > 0)
    {
    var fare = fares.Where(f => f != null && f is IDictionary<string, object>
        ).FirstOrDefault(f =>
        {
        var parsed = f as IDictionary<string, object>
            ;
            return parsed != null && parsed.ContainsKey("FarePaxType") && farePaxType.Equals(@ParseFarePaxTypeToPassengerType(parsed["FarePaxType"].ToString()));
            });

            if (fare != null)      {
            var dictFare = (IDictionary<string, object>
                ) fare;
                var exchangerate = 1m;
                if (dictFare.ContainsKey("ExchangeRate"))       {
                exchangerate = Framework.Extensions.ToDecimal((((IDictionary<string, object>
                    ) fare)["ExchangeRate"].ToString()));
                    }
                    calculatedMarkup = Framework.Extensions.ToDecimal(((IDictionary<string, object>
                        ) fare)["CalculatedMarkup"].ToString()) / exchangerate;
                        }
                        }
                        }

                        return calculatedMarkup;
                        }
                        }

<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title></title>
    <style>
		@@media print { 
			body&gt;*{ 
				display:none; 
			} 
			.printContainer { 
				visibility:visible; 
				display:block !important; 
			} 
			.report { 
				display:block !important; 
			} 
			.report style{ 
				visibility:hidden; 
			} 
			.titulo_azul{
				-webkit-print-color-adjust: exact;
				color: #fff;
				background-color: #006997;
			}
			th{
				-webkit-print-color-adjust: exact;
				color: #fff;
				background-color: #006997;
			}
		}
		</style>
</head>
<body>
    <table width="100%" cellpadding="0" cellspacing="0" align="center" style="background-color:none;font-family:Tahoma, Geneva, sans-serif;font-size:13px;font-weight:200;color:#022f63">
        <tbody>
            <tr>
                <td>
                    <table width="100%">
                        <tbody>
                       	    <tr>
                            	<td colspan="10" align="center">
	                                 <img src="@Model.AgencyContactInformation.Logo" alt="Envision" />
                                </td>
                        	</tr>
							
							<tr style="background:#fff">
								<td style="padding:10px 0 0 0">
								@if(Model.Arguments.HasCount() && Model.Arguments.Any(dm => dm.Key == "CustomMessage" && dm.Value.ToString().HasLength())){
								<span style="font-size:20px;font-weight:bold;color:#d14836;font-family:Arial,Helvetica,sans-serif">
								@Model.Arguments.First(dm => dm.Key == "CustomMessage").Value					
								</span>
								}
								@if (Model.DomainPath.HasLength()){
								var approverLink = "https://v2.travelagent.com.br/Authenticate/Login?redirectTo=%2Forder%2F" + Model.Id.ToString();
								<a href="@approverLink">(clique aqui para fazer a aprovação)</a>
								}
								</td>
							</tr>
							
                            <tr>
                                <td  colspan="8" style="margin: -6px 0 0 0 ;font-size: 16px;font-weight: 200; text-align: center; width: 100%;color: #fff;background-color: #006997; float: left;">
                                    <h1 style="padding:0px;font-size: 16px;font-weight: 200;text-align: center;width: 100%;color: #fff;background-color: #006997;" class="titulo_azul">
                                        CONFIRMAÇÃO DA RESERVA : <strong>OS @Model.Id</strong>
                                    </h1>
                                </td>
                            </tr>
                            <tr>
                                <td style="border:1px solid #006997;"colspan="10" >
                                    <table width="100%">
                                        <tr style=" background-color: #006997;;color:#fff;">
                                            <th colspan="5" style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Agência</th>
                                            <th colspan="5" style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Atendente/Operadores</th>
                                        </tr>
                                        <tr style="background-color:#eaeaea">
                                             <!-- CONFIRMAÇÃO DE RESERVA<br /><strong>OS @Model.Id</strong><br />-->
                                                    @{
                                                        var requestors = Model.LinksTemplates.Values.SelectMany(l => l.Select(x => ((BaseServiceTemplate)x).RequestingUserName)).Distinct().ToList();
                                                        var responsables = Model.LinksTemplates.Values.SelectMany(l => l.Select(x => ((BaseServiceTemplate)x).ResponsibleName)).Distinct().ToList();
                                                       <td colspan="5" style="padding: 5px;border-left: 1px solid #fff;">@Model.TravelAgencyName</td>
                                                       <td colspan="5" style="padding: 5px;border-left: 1px solid #fff;">   
                                                            @if (requestors.Any()){
                                                           <!-- @Raw(" - ") -->
                                                            <span style="font-size: 11px; font-weight:bold">@Raw("Atendente" + (requestors.Count > 1 ? "s" : "")): </span>@Raw(String.Join(",", requestors))
                                                            } <br />
                                                           <!-- <span style="font-size: 11px; font-weight:bold">Operadora </span>@Model.ConsolidatorName -->
                                                            @if (responsables.Any())
                                                            {
                                                           <!-- @Raw(" - ")-->
                                                            <span style="font-size: 11px; font-weight:bold">@Raw("Operador" + (responsables.Count > 1 ? "es" : "")) : </span>
                                                            @Raw(String.Join(",", responsables))
                                                            }
                                                        </td>
                                                    } 
                                        </tr>
                                    </table>
                                </td>        
                            </tr> 
                            <!--<tr>
                                <td>
                                    @if (!string.IsNullOrEmpty(@Model.AgencyContactInformation.Logo))                                      {
                                    <img src="@Model.AgencyContactInformation.Logo" style="max-width:350px;max-height:100px;" />
                                    }
                                </td>
                            </tr>-->
                        </tbody>
                    </table>
                </td>
            </tr>   
            <tr>
            	<td colspan="7" style="height:5px;"></td>
            </tr>         
            <tr>
                <td>
                    <table style="width:100%;border: 1px solid #006997;">
                        <tbody>
                            <!-- LINKS -->
                            @{
                                var linksTemplates = Model.LinksTemplates;
                                bool hasAirBook = linksTemplates.ContainsKey("AirBook");
                                bool hasHotelBook = linksTemplates.ContainsKey("HotelBook");
                                bool hasServiceBook = linksTemplates.ContainsKey("ServiceBook");
                                bool hasCarBook = linksTemplates.ContainsKey("CarBook"); var i = 0;
                            }
                            <!-- AIR BOOK -->
                            @if (hasAirBook) {
                                foreach (var dataTemplate in linksTemplates["AirBook"]) {
                                    var airBook = (AirBook)dataTemplate;
                                    <tr>
                                        <td colspan="10" >
                                            <table width="100%" style="border: 1px solid #006997;" >
                                                <tr>
                                                     <td colspan="3" style="padding: 5px;">
                                                        <h2 style="margin: 0px;padding: 0px;font-size: 20px;vertical-align: middle;height: 30px;line-height: 30px;font-weight: 600;" >
                                                             AEREO <span style="font-size: 14px;font-weight: 200;">   @Raw(String.Join(",", airBook.Pnrs.Select(c => c.Locator))) - @airBook.Status                                                             <th style="border-left:1px; color: #777 solid #fff;padding: 5px;font-weight:200;text-align:right;">
                                                            	PRAZO DA RESERVA:@airBook.Pnrs[0].ExpirationDate
                                                             </th>
                                                </span>
                                                        </h2>
                                                    </td>       
                                                </tr>
                                                <tr>
                                                    <td style="border:1px solid #006997" colspan="10">
                                                         <table width="100%">
                                                         <tr style="background-color:#006997;color:#fff;">
                                                            <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                            	Passageiros
                                                             </th>
                                                            <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                            	Data de Nascimento
                                                             </th>
                                                            <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                            	Tipo</th>
                                                        </tr>                                                           
                                                               @Passengers(airBook)
                                                         </table>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr style="background-color:#006997;color:#fff;">
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Cia Aerea</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Nº Vôo</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Origem</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Destino</th>                                            <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Saída</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Chegada</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Classe</th>
                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Equipamento</th>
                                    </tr>  		
                                    
                                    
                                                                  
                                    	foreach (var flight in airBook.Flights) {
                                        var color = i % 2 == 0 ? "#fafafa" : "#f5f5f5";                                          
                                        var flightExtra = airBook.BookingFares;
                                                                                                  
                                    <tr style="background-color:#eaeaea;text-align:center;">
                                        <td style="padding: 5px;border: 1px solid #fff;">                    
                                            <img width="35" src="@string.Concat("https://v2.travelagent.com.br/webcommon/Images/IconsCias/", @flight.CiaCode, ".gif")" alt="@flight.CiaName" />  
                                            <span>@flight.CiaName</span>                                           
                                        </td>                                                              
                                        <td style="padding: 5px;border: 1px solid #fff;">                                                               
                                            <span>@flight.FlightNumber</span>                                  
                                            
                                        </td>                                                              
                                        <td style="padding: 5px;border: 1px solid #fff;">                   
                                            @flight.OriginLong                                                             
                                        </td>                                                         
                                                                                             
                                        <td style="padding: 5px;border: 1px solid #fff;">                   
                                            @flight.DestinationLong  
                                        </td>                                                              
                                       <td style="padding: 5px;border: 1px solid #fff;"> 
                                       <span>@string.Concat(flight.DepartureDay.ToString().PadLeft(2, '0'), "/", flight.DepartureMonth.ToString().PadLeft(2, '0'), "/", flight.DepartureYear, " - ", flight.DepartureHour.ToString().PadLeft(2, '0'), ":", flight.DepartureMinutes.ToString().PadLeft(2, '0'))</span>                                           
                                        </td>                                                          
                                                                                             
                                        <td style="padding: 5px;border: 1px solid #fff;">                                          
                                            <span>@string.Concat(flight.ArrivalDay.ToString().PadLeft(2, '0'), "/", flight.ArrivalMonth.ToString().PadLeft(2, '0'), "/", flight.ArrivalYear, " - ", flight.ArrivalHour.ToString().PadLeft(2, '0'), ":", flight.ArrivalMinutes.ToString().PadLeft(2, '0'))</span>   
                                                                       
                                        </td>                                                              
                                        <td style="padding: 5px;border: 1px solid #fff;">                    
                                            @flight.CabinType                                                              
                                        </td>                                                          
                                                                                                
                                        <td>
                                         <span><!-- @flight.BaggagesIncluded -->
                                         	@flight.AirCraftType</span>
                                        </td>                                                          
                                    	</tr>                                    
                                                                                 
                                        i++;
                                    }
                                }
                                <tr style="height:10px"></tr>  
                            } <!-- FIM AIR BOOK -->
                             <!-- HOTEL BOOK -->
                            @if (hasHotelBook) {
                            foreach (var dataTemplate in linksTemplates["HotelBook"]) {
                            var hotelBook = (HotelBook)dataTemplate;                            
                            <tr>
                            	<td colspan="10">
                                	<table style="width:100%;border:1px solid #006997;">
                                    	<tr>
                                             <td colspan="3" style="padding: 5px;">
                                                <h2 style="margin: 0px;padding: 0px;font-size: 20px;vertical-align: middle;height: 30px;line-height: 30px;font-weight: 600;" >
                                                     <img src="https://storage.googleapis.com/uploadimages_ta//bfd99910-6db5-4b50-a205-1ffcd3b7441d.jpg"   style="float: left;margin: 0 8px 0 0px; vertical-align: middle;" alt="Envision Operadora"/>	
                                                     HOTEL 
                                                <strong style="font-size: 14px;font-weight: 200;"> <span>  @hotelBook.HotelLocator - @hotelBook.Status </span></strong></h2>
                                            </td>                    
                                        </tr>
                                         <tr>
                                            <td colspan="7">
                                                 <table width="100%" style="border:1px solid #006997;">                   
                                                    <tr style="background-color:#006997;color:#fff;">
                                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                        Hóspedes</th>
                                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                        Data de Nascimento</th>
                                                        <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                                        Tipo</th>
                                                    </tr>
                                                    @Passengers(hotelBook)
                                                 </table>
                                            </td>
                                        </tr>
                                    
                                    </table>                                
                                </td>
                            </tr>
                            <tr style="height:10px"></tr>
                              <tr>
                                <td colspan="10">
                                    <h1 style="padding: 5px 10px;margin: 0px 0 0 0;font-size: 16px;font-weight: 600;text-align: left; width: auto;
    color: #fff; background-color: #006997;" class="titulo_azul">
                                      Dados do Hotel 
                                   </h1>
                                </td>
                            </tr>
                            <tr style="background-color:#006997;color:#fff;" >
                                <th style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;" colspan="10">Nome do Hotel</th>                            </tr>
                            <tr style="background-color:#f5f5f5">
                            	<td colspan="10" style="padding: 5px;border-left: 1px solid #fff;">
                                	@("{0}{1}{2}".FormatMe(hotelBook.HotelName, " - ", hotelBook.RoomName))
                                </td>
                            </tr>
                             <tr style="background-color:#006997;color:#fff;">
                            	<th colspan="3" style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Endereço</th>
                                <th colspan="3" style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Cidade/Pais</th>
                                <th colspan="3" style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">
                                Número do Voucher</th>
                            </tr>
                            <tr style="background-color:#f5f5f5">                               
                                <td colspan="3" style="padding: 5px;border-left: 1px solid #fff;"> 
                                 @string.Concat(hotelBook.Street, " ", hotelBook.Number, " ", hotelBook.Complement)
                                 </td>
                                <td colspan="3" style="padding: 5px;border-left: 1px solid #fff;">@hotelBook.HotelCity </td>
                                <td colspan="3" style="padding: 5px;border-left: 1px solid #fff;">@hotelBook.VoucherNumber   </td>
                            </tr>
                            <tr style="background-color:#006997;color:#fff;">
                                <th colspan="2"  style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Quarto</th>
                                <th colspan="2"  style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Regime</th>
                                <th colspan="2"  style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Data do Checkin</th>
                                <th colspan="2"  style="border-left:1px solid #fff;padding: 5px;font-weight:200;text-align:left;">Data do Checkout</th>
                            </tr>
                            <tr style="background-color:#f5f5f5">
                                <td colspan="2"  style="padding: 5px;border-left: 1px solid #fff;">
                                 @if (hotelBook.PassengerCount == "1") {
                                    @Raw("SGL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "2") {
                                    @Raw("DBL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "3") {
                                    @Raw("TPL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "4")
                                    {
                                    @Raw("QUA - ")
                                    }
                                    @hotelBook.RoomName
                                  </td>
                             	 <td colspan="2"  style="padding: 5px;border-left: 1px solid #fff;">
                                 	  @if (!String.IsNullOrWhiteSpace(hotelBook.Board))
                                    {                                                  
                                    <span style="font-size: 11px; font-weight:bold">Regime </span>   
                                    @hotelBook.Board 
                                    }
                                 </td>
                                <td colspan="2"  style="padding: 5px;border-left: 1px solid #fff;"> @hotelBook.CheckIn </td>                                           
                                <td colspan="2"  style="padding: 5px;border-left: 1px solid #fff;">@hotelBook.CheckOut</td>
                            </tr>   
                            
                            
                                
                            
                            
                            <!--
                          
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;"> 
                            	 <td>
                                 	<span style="font-size: 11px; font-weight:bold">Endereço </span> 
                                    @string.Concat(hotelBook.Street, " ", hotelBook.Number, " ", hotelBook.Complement)
                                                                       </td>                                          
                                   <td>                                              
                                   		<span style="font-size: 11px; font-weight:bold">Cidade </span>                                              @hotelBook.City                                         
                                   </td>  
                             </tr>
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;"> 
                             	<td>
                            	<span style="font-size: 11px; font-weight:bold">
                                Data do CheckIn 
                                </span>
                               
                                  @hotelBook.CheckIn  
                                </td>                                          
                                <td>
                                	<span style="font-size: 11px; font-weight:bold">Data do CheckOut </span>                                              @hotelBook.CheckOut                                          
                                    </td>                                   
                                    <td>
                                    	 <span style="font-size: 11px; font-weight:bold">Número do Voucher </span>                                              @hotelBook.VoucherNumber                                          
                                     </td>
                             </tr>
                               <tr style="background-color:#fafafa; font-size:14px; color:#777;">
                                <td>
                                    <span style="font-size: 11px; font-weight:bold">Quarto </span>
                                    @if (hotelBook.PassengerCount == "1") {
                                    @Raw("SGL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "2") {
                                    @Raw("DBL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "3") {
                                    @Raw("TPL - ")
                                    }
                                    else if (hotelBook.PassengerCount == "4")
                                    {
                                    @Raw("QUA - ")
                                    }
                                    @hotelBook.RoomName
                                  </td>
                                    <td style="background-color:#fafafa; font-size:14px; color:#777;"> 
                                     @if (!String.IsNullOrWhiteSpace(hotelBook.Board))
                                       {   
                                       	<span style="font-size: 11px; font-weight:bold">Regime </span> 
                                  		@hotelBook.Board
                                        }                                          
                                    </td>
                                 </tr>-->
                            	}
                            }                              
                            <!-- FIM HOTEL BOOK -->  
                             <!-- SERVICE BOOK -->
                            @if (hasServiceBook) {
                            foreach (var dataTemplate in linksTemplates["ServiceBook"]) {
                            var serviceBook = (ServiceBook)dataTemplate;
                            <tr style="height:10px"></tr>
                            <tr style="color: #E6567A;">                                          <td colspan="4">                                              <span style="font-size: x-large; font-weight: bold;">                                                  <img src="https://media.lovemondays.com.br/logos/5d72f4/envision-tecnologia-1-original.png" />SERVIÇO                                              </span>                                              <span style="text-align:right; font-weight: bold;">                                                  @serviceBook.Locator - @serviceBook.Status                                              </span>                                          </td>                                      </tr>
                            <tr />
                            <tr style="font-size: 14px; color: #777;">                                          <td colspan="4">                                              <strong>Passageiros</strong>                                          </td>                                      </tr>                                        @Passengers(serviceBook)
                            <tr style="height:10px"></tr>
                            <tr style="font-size: 14px; color: #777;">                                          <td colspan="4">                                              <strong>Serviço</strong>                                          </td>                                      </tr>
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;">                                          <td colspan="4">                                              <span style="font-size: 11px; font-weight:bold">Nome </span>                                              @serviceBook.ServiceName                                          </td>                                      </tr>
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;">                                          <td colspan="4">                                              <span style="font-size: 11px; font-weight:bold">Datas </span>                                              @serviceBook.SelectedDates                                          </td>                                      </tr>                                        if (!String.IsNullOrWhiteSpace(serviceBook.VoucherNumber))                                      {
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;">                                              <td colspan="4">                                                  <span style="font-size: 11px; font-weight:bold">Número do Voucher </span>                                                  @serviceBook.VoucherNumber                                              </td>                                          </tr>                                      }                                        if (serviceBook.ServiceBookVenue != null && !String.IsNullOrWhiteSpace(serviceBook.ServiceBookVenue.Name))                                      {
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;">                                              <td colspan="4">                                                  <span style="font-size: 11px; font-weight:bold">Estabelecimento </span>                                                  @serviceBook.ServiceBookVenue.Name                                              </td>                                          </tr>                                      }                                        if (!String.IsNullOrWhiteSpace(serviceBook.ServiceDescription))                                      {
                            <tr style="background-color:#fafafa; font-size:14px; color:#777;">                                              <td colspan="4">                                                  <span style="font-size: 11px; font-weight:bold">Descrição </span>                                                  @serviceBook.ServiceDescription                                              </td>                                          </tr>
                            }
                            }
                            }
                            <!-- FIM SERVICE BOOK -->
                            <!-- CAR BOOK -->
                            @if (hasCarBook) {
                                <tr style="height:10px"></tr>
                                foreach (var dataTemplate in linksTemplates["CarBook"]) {
                                var carBook = (CarBook)dataTemplate;
                                <tr style="font-size: x-large; color: #e47656; font-weight: bold;">                                          <td colspan="4">                                              <img src="https://v2.travelagent.com.br/webcommon/images/tourismicons/car.png" />CARROS                                          </td>                                      </tr>
                                <tr style="font-size: 14px; color: #777; font-weight: bold;">                                          <td colspan="2">Modelo</td>                                          <td colspan="2">Categoria</td>                                      </tr>
                                <tr style="font-size: 14px; color: #777;">                                          <td colspan="2">@carBook.CarModelName</td>                                          <td colspan="2">@carBook.CarCategory</td>                                      </tr>
                                <tr style="font-size: 14px; color: #777; font-weight: bold;">                                          <td colspan="2">Transmissão</td>                                          <td colspan="2">Tipo</td>                                      </tr>
                                <tr style="font-size: 14px; color: #777;">                                          <td colspan="2">@carBook.CarTransmission</td>                                          <td colspan="2">@carBook.CarType</td>                                      </tr>
                                <tr style="font-size: 14px; color: #777; font-weight: bold;">                                          <td colspan="2">Retirada</td>                                          <td colspan="2">Devolução</td>                                      </tr>
                                <tr style="font-size: 14px; color: #000;">                                          <td colspan="2">@carBook.PickupLocationName</td>                                          <td colspan="2">@carBook.DropoffLocationName</td>                                      </tr>
                                    if (carBook.SpecialEquipments.HasCount()) {
                                        <tr style="font-size: 14px; color: #777; font-weight: bold;">
                                            <td colspan="4">Equipamentos extras</td>
                                        </tr>
                                        foreach (var specialEquipment in carBook.SpecialEquipments) {
                                        <tr>
                                            <td colspan="4"> @specialEquipment.Description </td>
                                        </tr>
                                        }
                                    }
                                }                              
                            }                              <!-- FIM CAR BOOK -->                              
                            <!-- FIM LINKS -->                              
                            <!-- CAIXA !-->
                        </tbody>
                    </table>
                    <tr>
                    	<td colspan="10" style="height:5px"></td>
                    </tr>
                    <table width="100%" style="border: 1px solid #006997;font-family: Tahoma, Geneva, sans-serif;font-size: 13px;
    font-weight: 200; color: #022f63;">
                        <tbody>
                            <tr>
                                 <td colspan="3" style="padding: 5px;">
                                    <h2 style="margin: 0px;padding: 0px;font-size: 20px;vertical-align: middle;height: 30px;
                                    line-height: 30px;font-weight:600; color: #022f63;" >                                    
                                         <img src="https://storage.googleapis.com/uploadimages_ta//9dbd9a22-678a-4a2a-aff1-d88e57fe4a7f.jpg"   
                                         style="float: left;margin: 0 8px 0 0px; vertical-align: middle;" alt="Envision Operadora"/>	
                                        VALORES
                                    </h2>
                                </td>                    
                            </tr>
                            
                            
                            @{
                            var anyForeignCurrency = linksTemplates.Any(c => c.Value.Any(d => ((BaseServiceTemplate)d).SummaryAmounts.ExchangeRate > 1));
                            }
                            <tr style="background-color:#006997;color:#fff;">
                                <td style="padding:5px;width: 50%">Descrição</td>
                                <td style="padding:5px">Viajantes</td>
                                <td style="padding:5px">Tarifas*</td>
                                <td style="padding:5px">Taxas*</td>
                                <td style="padding:5px">Serviços*</td>
                                <td style="padding:5px">Total</td>
                            </tr>

                            <!-- LINKS -->
                            @if (hasAirBook) {
                            foreach (var dataTemplate in linksTemplates["AirBook"]) {
                            var airBook = (AirBook)dataTemplate;
                            <tr style="background-color:#eaeaea">
                                <td>            @airBook.Description           </td>
                                <td>            @string.Concat(airBook.SummaryAmounts.PassengersCount)           </td>
                                <td>@airBook.SummaryAmounts.CurrencyCode             @string.Concat(" ", airBook.SummaryAmounts.FareAmountByPassengerFormatted)           </td>
                                <td>@airBook.SummaryAmounts.CurrencyCode             @string.Concat(" ", airBook.SummaryAmounts.TaxesAmountByPassengerFormatted)           </td>
                                <td>@airBook.SummaryAmounts.CurrencyCode             @string.Concat(" ", airBook.SummaryAmounts.ServiceTaxesAmountByPassengerFormatted)           </td>
                                <td>@airBook.SummaryAmounts.CurrencyCode             @string.Concat(" ", airBook.SummaryAmounts.TotalAmountFormatted)           </td>
                            </tr>
                            }
                            }
                            @if (hasHotelBook)        {
                            foreach (var dataTemplate in linksTemplates["HotelBook"])         {
                            var hotelBook = (HotelBook)dataTemplate;
                            <tr style="background-color:#eaeaea">
                                <td>            @("{0}{1}{2}".FormatMe(hotelBook.HotelName," - ", hotelBook.RoomName))           </td>
                                <td>            @string.Concat(hotelBook.SummaryAmounts.PassengersCount)           </td>
                                <td>@hotelBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", hotelBook.SummaryAmounts.FareAmountByPassengerFormatted)           </td>
                                <td>@hotelBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", hotelBook.SummaryAmounts.TaxesAmountByPassengerFormatted)           </td>
                                <td>@hotelBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", hotelBook.SummaryAmounts.ServiceTaxesAmountByPassengerFormatted)           </td>
                                <td>@hotelBook.SummaryAmounts.CurrencyCode           @string.Concat(" ", hotelBook.SummaryAmounts.TotalAmountFormatted)           </td>
                            </tr>
                            }
                            }
                            @if (hasServiceBook)        {
                            foreach (var dataTemplate in linksTemplates["ServiceBook"])         {
                            var serviceBook = (ServiceBook)dataTemplate;
                             <tr style="background-color:#eaeaea">
                                <td>            @serviceBook.ServiceName           </td>
                                <td>            @string.Concat(serviceBook.SummaryAmounts.PassengersCount)           </td>
                                <td>@serviceBook.SummaryAmounts.CurrencyCode           @string.Concat(" ", serviceBook.SummaryAmounts.FareAmountByPassengerFormatted)           </td>
                                <td>@serviceBook.SummaryAmounts.CurrencyCode           @string.Concat(" ", serviceBook.SummaryAmounts.TaxesAmountByPassengerFormatted)           </td>
                                <td>@serviceBook.SummaryAmounts.CurrencyCode           @string.Concat(" ", serviceBook.SummaryAmounts.ServiceTaxesAmountByPassengerFormatted)           </td>
                                <td>@serviceBook.SummaryAmounts.CurrencyCode           @string.Concat(" ", serviceBook.SummaryAmounts.TotalAmountFormatted)           </td>
                            </tr>
                            }
                            }
                            @if (hasCarBook)        {
                            foreach (var dataTemplate in linksTemplates["CarBook"])         {
                            var carBook = (CarBook)dataTemplate;
                             <tr style="background-color:#eaeaea">
                                <td>            @carBook.CarModelName           </td>
                                <td>            @string.Concat(carBook.SummaryAmounts.PassengersCount)           </td>
                                <td>@carBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", carBook.SummaryAmounts.FareAmountByPassengerFormatted)           </td>
                                <td>@carBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", carBook.SummaryAmounts.TaxesAmountByPassengerFormatted)           </td>
                                <td>@carBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", carBook.SummaryAmounts.ServiceTaxesAmountByPassengerFormatted)           </td>
                                <td>@carBook.SummaryAmounts.CurrencyCode            @string.Concat(" ", carBook.SummaryAmounts.TotalAmountFormatted)           </td>
                            </tr>
                            }
                            }
                            <!-- FIM LINKS -->
                            <!--<tr style="background-color:#eaeaea">                                
                                <td colspan="10" style="font-size: 10px;">
                                           <p style="float: right;">*valores por viajante</p>          
                                 </td>
                            </tr>-->
                            <tr>                               
                                <td colspan="10" style="background-color:#006997; font-size:14px; color:#fff; 
                                font-weight:600;padding:5px;text-align:right;">
                                Total da Venda</td>
                            </tr>
                            <tr>                                
                               <td colspan="10" style="background-color: #fafafa; font-size: 16px; color: #777; font-weight: bold;
                               text-align:right;">
                               		@Model.SummaryAmounts.TotalAmountFormatted
                                </td>
                            </tr>                            
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="10" style="height:5px"></td>
            </tr>
            <tr>
            	<td colspan="10">
                	<table style="width:100%;padding:10px 0 0 0 ">
                    	  <tr>
                                <td colspan="10">
                                    <h1 style="padding: 5px 10px;margin: 0px 0 0 0;font-size: 16px;font-weight: 600;text-align: left; width: auto;
                                color: #fff; background-color: #;" class="titulo_azul">
                                      
                    </table>
                </td>            
            </tr>               
            <tr>
                <td colspan="10">
                               
                    </table>
                 </td>
            </tr>        
        </tbody>
    </table>
</body>
</html>